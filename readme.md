# TOTP Node.js Application with Docker

This project is a simple Node.js application that exposes an API endpoint to generate Time-based One-Time Password (TOTP) codes compatible with Google Authenticator. The application is containerized using Docker, and environment variables allow for easy configuration of the port and secret key.

## Features

- Generate TOTP codes using a secure secret.
- Exposes a REST API endpoint (`/totp`) to retrieve the current TOTP.
- Dockerized for easy deployment.
- Environment variables for configurable port and TOTP secret.
- Docker Compose scripts for simple service management.

## Prerequisites

- [Docker](https://www.docker.com/get-started)
- [Docker Compose](https://docs.docker.com/compose/install/)

## Project Structure

```
.
├── Dockerfile            # Defines the Docker image
├── docker-compose.yml    # Manages the Docker services
├── prepare-env.sh        # Script to create the .env file
├── up.sh                 # Script to start the Docker Compose services
├── down.sh               # Script to stop the Docker Compose services
├── .env                  # Environment variables (auto-generated by prepare-env.sh)
├── main.js               # Main Node.js application
├── package.json          # Project dependencies and metadata
└── README.md             # Project documentation

```


## Setup Instructions

### 1. Clone the Repository

```bash
git clone <repository-url>
cd totp-node-app
```
### 2. Generate the .env File
Run the prepare-env.sh script to create the .env file. The script will prompt you to provide a TOTP secret (in Base32 format) and optionally a port number (defaults to 3000 if left blank).

```bash
./prepare-env.sh
```
Sample .env file content:

```.env
PORT=3000
TOTP_SECRET=JBSWY3DPEHPK3PXP
```
### 3. Build and Start the Application
To build and start the Docker Compose services, run the up.sh script:

```bash
./up.sh
```

This will build the Docker image and start the services in detached mode. The application will be accessible on http://localhost:\<PORT\> where \<PORT\> is defined in the .env file (default is 3000).

### 4. Access the TOTP Endpoint
To get the current TOTP code, you can make a GET request to the /totp endpoint:

```bash
curl http://localhost:3000/totp
```
Sample response:

```
{
  "totp": "123456"
}
```
### 5. Stop the Application
To stop and remove the Docker Compose services, run the down.sh script:
```bash
./down.sh
```

## Environment Variables
The application uses the following environment variables defined in the .env file:

PORT: The port on which the application runs (default: 3000).
TOTP_SECRET: The Base32 secret used for generating TOTP codes.

## License
This project is licensed under the MIT License.